Set i Conjunto de barrios /b1 * b218/;
Set e Conjunto de estaciones /e1 * e69/;
Set ejes Conjunto de ejes espaciales /coordenadaX, coordenadaY/;
Scalar poblacionDeCali poblacion de Cali /2471474/;

table coordenadasBarrios(i,ejes) conjunto de coordenadas para i
        coordenadaX    coordenadaY
b1      65             62
b2      66             35
b3      54             31
b4      67             57
b5      41             17
b6      67             40
b7      109            26
b8      64             67
b9      80             92
b10     35             95
b11     41             94
b12     45             93
b13     61             96
b14     115            19
b15     9              41
b16     85             68
b17     64             51
b18     55             66
b19     58             53
b20     73             21
b21     86             18
b22     55             22
b23     52             58
b24     32             60
b25     99             40
b26     60             43
b27     7              70
b28     83             12
b29     98             52
b30     107            25
b31     104            25
b32     85             106
b33     74             75
b34     91             30
b35     115            56
b36     97             49
b37     55             73
b38     58             89
b39     23             84
b40     106            56
b41     110            33
b42     96             69
b43     13             66
b44     66             105
b45     115            52
b46     75             109
b47     4              81
b48     68             109
b49     79             50
b50     84             39
b51     74             111
b52     78             72
b53     70             69
b54     14             45
b55     49             44
b56     67             37
b57     83             15
b58     79             45
b59     84             47
b60     117            44
b61     74             57
b62     124            23
b63     80             24
b64     96             45
b65     57             24
b66     68             67
b67     49             33
b68     81             77
b69     79             84
b70     65             58
b71     101            24
b72     82             110
b73     89             76
b74     64             69
b75     56             78
b76     83             75
b77     24             68
b78     37             89
b79     19             70
b80     15             85
b81     111            26
b82     40             40
b83     60             47
b84     27             64
b85     47             59
b86     30             93
b87     42             56
b88     91             53
b89     75             94
b90     77             64
b91     73             73
b92     66             46
b93     50             79
b94     18             47
b95     55             62
b96     73             62
b97     78             68
b98     104            44
b99     83             55
b100    27             61
b101    50             39
b102    25             89
b103    77             10
b104    66             53
b105    52             68
b106    44             86
b107    85             98
b108    110            39
b109    88             79
b110    73             65
b111    126            54
b112    80             13
b113    12             82
b114    30             79
b115    29             75
b116    105            20
b117    87             82
b118    74             81
b119    74             68
b120    27             85
b121    70             88
b122    80             108
b123    66             93
b124    66             98
b125    41             89
b126    78             79
b127    82             61
b128    108            19
b129    79             103
b130    96             58
b131    112            17
b132    67             89
b133    121            29
b134    18             83
b135    84             86
b136    102            70
b137    113            26
b138    47             30
b139    61             79
b140    86             31
b141    52             54
b142    22             66
b143    75             88
b144    156            40
b145    6              87
b146    25             95
b147    20             93
b148    23             94
b149    97             100
b150    95             102
b151    91             99
b152    128            20
b153    40             60
b154    92             105
b155    109            46
b156    29             54
b157    66             60
b158    111            19
b159    77             65
b160    93             41
b161    61             58
b162    74             102
b163    67             101
b164    49             91
b165    46             98
b166    92             61
b167    72             86
b168    58             60
b169    35             69
b170    71             65
b171    73             31
b172    55             42
b173    91             50
b174    85             51
b175    19             88
b176    11             86
b177    39             87
b178    44             50
b179    54             46
b180    72             72
b181    34             47
b182    99             40
b183    71             50
b184    59             69
b185    71             26
b186    62             64
b187    53             40
b188    87             42
b189    41             39
b190    123            28
b191    52             89
b192    79             17
b193    57             57
b194    69             74
b195    52             50
b196    57             24
b197    45             22
b198    81             16
b199    58             85
b200    32             59
b201    89             65
b202    135            39
b203    77             51
b204    12             90
b205    90             96
b206    92             75
b207    63             104
b208    85             16
b209    38             46
b210    71             79
b211    61             86
b212    34             84
b213    88             55
b214    73             100
b215    50             75
b216    70             65
b217    46             4
b218    73             77;
table coordenadasEstaciones(e,ejes) conjunto de coordenadas para j
        coordenadaX    coordenadaY
e1      47             5
e2      15             22
e3      40             44
e4      34             53
e5      27             46
e6      18             65
e7      21             57
e8      49             18
e9      55             46
e10     52             33
e11     56             36
e12     28             83
e13     67             45
e14     50             53
e15     24             84
e16     14             80
e17     28             71
e18     5              80
e19     26             67
e20     30             90
e21     35             97
e22     36             89
e23     53             68
e24     67             56
e25     84             62
e26     52             71
e27     87             47
e28     113            58
e29     91             28
e30     48             50
e31     124            27
e32     111            25
e33     83             21
e34     126            42
e35     51             30
e36     68             31
e37     90             19
e38     61             31
e39     77             10
e40     82             15
e41     83             76
e42     75             81
e43     59             90
e44     73             90
e45     72             106
e46     86             95
e47     68             100
e48     93             72
e49     84             86
e50     98             59
e51     74             109
e52     90             104
e53     97             101
e54     51             37
e55     4              52
e56     59             43
e57     0              0
e58     0              0
e59     50             37
e60     51             35
e61     46             69
e62     51             49
e63     0              23
e64     50             40
e65     51             38
e66     52             46
e67     75             32
e68     53             44
e69     49             100;

Parameters homicidios(i) cantidad de toneladas de basura de un distrito j para exportar
/b1      0
b2      1
b3      0
b4      3
b5      3
b6      4
b7      1
b8      0
b9      17
b10     9
b11     1
b12     2
b13     9
b14     3
b15     3
b16     8
b17     0
b18     2
b19     11
b20     1
b21     3
b22     5
b23     2
b24     1
b25     1
b26     5
b27     6
b28     18
b29     1
b30     1
b31     1
b32     7
b33     4
b34     2
b35     5
b36     1
b37     1
b38     10
b39     3
b40     3
b41     1
b42     18
b43     5
b44     6
b45     3
b46     1
b47     17
b48     5
b49     2
b50     1
b51     10
b52     5
b53     6
b54     1
b55     10
b56     2
b57     6
b58     1
b59     6
b60     5
b61     6
b62     3
b63     4
b64     1
b65     1
b66     2
b67     1
b68     9
b69     20
b70     1
b71     1
b72     3
b73     23
b74     10
b75     1
b76     16
b77     4
b78     2
b79     6
b80     2
b81     1
b82     1
b83     4
b84     1
b85     2
b86     4
b87     2
b88     2
b89     15
b90     1
b91     1
b92     1
b93     1
b94     3
b95     4
b96     2
b97     1
b98     2
b99     3
b100    4
b101    1
b102    2
b103    5
b104    3
b105    1
b106    2
b107    8
b108    2
b109    10
b110    2
b111    1
b112    23
b113    3
b114    2
b115    2
b116    11
b117    26
b118    5
b119    5
b120    1
b121    13
b122    5
b123    9
b124    2
b125    7
b126    5
b127    1
b128    2
b129    20
b130    11
b131    1
b132    9
b133    2
b134    1
b135    23
b136    2
b137    1
b138    1
b139    6
b140    2
b141    8
b142    2
b143    8
b144    3
b145    1
b146    5
b147    9
b148    2
b149    10
b150    1
b151    2
b152    4
b153    2
b154    27
b155    2
b156    3
b157    0
b158    1
b159    11
b160    1
b161    3
b162    5
b163    12
b164    3
b165    4
b166    10
b167    6
b168    4
b169    1
b170    6
b171    2
b172    9
b173    12
b174    1
b175    5
b176    2
b177    3
b178    9
b179    1
b180    3
b181    4
b182    3
b183    7
b184    3
b185    1
b186    2
b187    3
b188    3
b189    1
b190    1
b191    6
b192    30
b193    4
b194    3
b195    18
b196    1
b197    7
b198    6
b199    3
b200    2
b201    16
b202    1
b203    4
b204    6
b205    6
b206    19
b207    16
b208    3
b209    2
b210    5
b211    5
b212    2
b213    1
b214    3
b215    2
b216    2
b217    3
b218    1/;


Integer Variable patrulleros(e,i) cantidad de patrulleros enviados desde la estacion e al barrio i;
patrulleros.up(e,i) = 10000;
Integer Variable subintendentes(e) cantidad de subintendentes en la estacion e;
subintendentes.up(e) = 10000;
Integer Variable intendentes(e) cantidad de intendentes en la estacion e;
intendentes.up(e) = 10000;
Integer Variable intendentes_jefes(e) cantidad de intendentes jefes en la estacion e;
intendentes_jefes.up(e) = 10000;
Integer Variable subcomisarios cantidad de subcomisarios en la ciudad;
subcomisarios.up = 1000;
Integer Variable comisarios cantidad de comisarios en la ciudad;


Free Variable z funcion a optimizar;

Equations
         fun_obj                         funcion objetivo a optimizar
         restriccionSubIntendentes       Restriccion que indica el numero de subintendentes requeridos para coordinar correctamente a los patrulleros en la estacion e.
         restriccionIntendentes          Restriccion que indica el numero de intendentes requeridos para coordinar correctamente a los patrulleros en la estacion e.
         restriccionIntendentes_jefes    Restriccion que indica el numero de intendentes jefes requeridos para coordinar correctamente a los patrulleros en la estacion e.
         restriccionSubComisarios        Restriccion que indica el numero de subcomisarios requeridos para coordinar correctamente a los patrulleros de la ciudad.
         restriccionComisarios           Restriccion que indica el numero de comisarios requeridos para coordinar correctamente a los patrulleros de la ciudad.
         restriccion300Por100000         Restriccion que busca asegurar que haya 300 patrulleros por cada 100000 habitantes
         restriccionHomicidios           Restriccion que indica el numero de policias necesario por homicidios
;


fun_obj                                  ..      z =e= (Sum((e,i),(4500)* sqrt(power(abs(coordenadasBarrios(i,'coordenadaX')-coordenadasEstaciones(e,'coordenadaX')),2) + power(abs(coordenadasBarrios(i,'coordenadaY')-coordenadasEstaciones(e,'coordenadaY')),2))) ) + (sum((e,i), patrulleros(e,i)* 1444317)) + (sum(e, subintendentes(e)* 1811292)) + (sum(e, intendentes(e)* 2305409)) + (sum(e, intendentes_jefes(e)* 2428664)) + (subcomisarios * 2551070) + (comisarios * 3004471);
restriccionSubIntendentes(e)             ..      Sum(i, patrulleros(e,i))/9 =l= subintendentes(e);
restriccionIntendentes(e)                ..      Sum(i, patrulleros(e,i))/5 =l= intendentes(e);
restriccionIntendentes_jefes(e)          ..      Sum(i, patrulleros(e,i))/34 =l= intendentes_jefes(e);
restriccionSubComisarios                 ..      Sum((e,i), patrulleros(e,i))/131 =l= subcomisarios;
restriccionComisarios                    ..      Sum((e,i), patrulleros(e,i))/707 =l= comisarios;
restriccion300por100000                  ..      (poblacionDeCali/100000)*300 =l= Sum((e,i), patrulleros(e,i));
restriccionHomicidios(i)                 ..      Sum(e, patrulleros(e,i)) =g= homicidios(i)*2;



model modelo /all/;

option minlp = BONMIN;
solve modelo using minlp minimizing z;
Display patrulleros.l;
Display subintendentes.l;
Display intendentes.l;
Display intendentes_jefes.l;
Display subcomisarios.l;
Display comisarios.l;
Display z.l, z.m
